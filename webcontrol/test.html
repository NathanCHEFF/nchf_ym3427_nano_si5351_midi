<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">

</head>
<body>
  <input type="button" onclick='openSerialPort()' value='taapme'></input>
  <input type="button" onclick='send()' value='taapme2'></input>
    <input type="button" onclick='send2()' value='taapme3'></input>
  <script>
  if ("serial" in navigator) {
    //console.log("браузер поддерживает com порт")
  }

let port= null;
let portTextWrite = null

let myVend = [{usbProductId: 29987, usbVendorId: 6790},]

  async function openSerialPort(){
   const ports = await  navigator.serial.getPorts()
   console.log(ports)
  port = ports[0]
  
    //const port = await navigator.serial.requestPort({ myVend });
    
    await port.open({ 
      baudRate :115200,
      dataBits: 8,
      stopBits: 1,
      parity: "none",
      bufferSize: 255,
      flowControl: "none",
    });
    
    console.log(port.getInfo())
    let textEncoder = new TextEncoderStream();
    let writableStreamClosed = textEncoder.readable.pipeTo(port.writable);
    let writer = textEncoder.writable.getWriter();
    portTextWrite = writer
  }
  
  async function send(){
    if(port == null){return null}
    await portTextWrite.write(144);
    await portTextWrite.write(65);
    await portTextWrite.write(177);
    //console.log(`sent ${cmd} to serial board`)
}

  async function send2(){
    if(port == null){return null}
    await portTextWrite.write(144);
    await portTextWrite.write(65);
    await portTextWrite.write(00);
    //console.log(`sent ${cmd} to serial board`)
}
  </script>
</body>
</html>
